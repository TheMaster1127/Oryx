# Oryx

A minimalist, portable, and easily embeddable virtual machine and instruction set designed for scripting and language development.

## Table of Contents
1.  [What is Oryx?](#what-is-oryx)
2.  [Key Features](#key-features)
3.  [Getting Started](#getting-started)
4.  [Embedding the VM](#embedding-the-vm)
5.  [The Oryx Ecosystem](#the-oryx-ecosystem)
6.  [Project Structure](#project-structure)
7.  [License](#license)

---

## What is Oryx?

The Oryx project provides a simple, self-contained virtual machine that executes a human-readable instruction set called **Oryx IR** (Intermediate Representation).

The entire VM is written in **HTVM**, a language that transpiles to multiple high-level languages. This means the Oryx VM is not a single executable but a source library that can be directly used in projects written in:
*   **C++**
*   **JavaScript** / **TypeScript**
*   **Python**

The primary goal of Oryx is to serve as a stable, easy-to-target backend for new, high-level programming languages.

---

## Key Features

*   **Extreme Portability:** Because it's written in HTVM, the Oryx VM library is available for C++, JavaScript/TypeScript, and Python out of the box, with identical behavior across all platforms.
*   **Minimalist by Design:** The instruction set is small and easy to learn, focusing on core functionality like arithmetic, control flow, stack operations, and basic I/O.
*   **Easily Embeddable:** The entire VM is designed to be used as a library. Simply include the source file in your project and call a single function to execute code.
*   **Zero External Dependencies:**
    *   The **JavaScript** and **Python** versions run with no external libraries required.
    *   The **C++** version relies only on standard libraries.
    *   *Note:* The TypeScript version may require the `fs` module for file operations depending on the environment.

---

## Getting Started

The Oryx VM is a library, not a standalone program. To run Oryx IR code, you must embed the VM into a host application (even a very simple one).

### Step 1: Write your Oryx IR code

Create a file containing your instructions. The file extension does not matter, but `.oryxir` is the convention.

**`my_script.oryxir`**
```oryxir
; This is a comment.
; Let's calculate and print 5 + 10.
mov r1, 5
add r1, 10
call print
```

### Step 2: Create a Host Application

Below is a simple example in Python. The process is similar for C++ and JavaScript.

**`run_oryx.py`**
```python
# First, ensure the transpiled 'oryx_vm.py' library is in the same directory.
# This file is generated by HTVM from the original source.
from oryx_vm import Oryx_VM, OryxAPI_GetVariable, OryxAPI_GetArray

# Read the Oryx IR code into a string
with open('my_script.oryxir', 'r') as f:
    oryx_code = f.read()

print("--- Running Oryx VM ---")

# Execute the code by calling the main VM function
result = Oryx_VM(oryx_code)

print("--- Oryx VM Finished ---")
print(f"VM exit state: {result}")
```
*You must replace `oryx_vm` with the correct name of the generated Python file.*

### Step 3: Run the Host

```bash
python run_oryx.py

# Expected Output:
# --- Running Oryx VM ---
# 15.0
# --- Oryx VM Finished ---
# VM exit state: success
```

---

## Embedding the VM

The API is intentionally simple, consisting of a main execution function and several helper functions for retrieving state.

### `Oryx_VM(code)`
The main entry point. Executes a string of Oryx IR code.
*   **Parameter:** `code` (string) - The Oryx IR source code to execute.
*   **Returns:** (string) - `"success"` or an error message.

### `OryxAPI_GetVariable(name)`
Retrieves the final value of a variable or register after the VM has finished executing.
*   **Parameter:** `name` (string) - The name of the variable (e.g., `"my_var"`) or register (e.g., `"r1"`).
*   **Returns:** (string) - The final value of the variable.

### `OryxAPI_GetArray(name)`
Retrieves the final contents of an array as a list/array in the host language.
*   **Parameter:** `name` (string) - The name of the array (e.g., `"my_list"`).
*   **Returns:** (array of strings) - The contents of the array.

---

## The Oryx Ecosystem

This repository currently contains the **Oryx VM and IR**, which is the foundational backend. The next major step in the project is to build the **Oryx programming language**â€”a high-level, user-friendly language that transpiles to Oryx IR.

The intended workflow is:

`Oryx Language -> Oryx Compiler -> Oryx IR -> Oryx VM`

This allows other developers to either use the high-level Oryx language or to target the Oryx IR with their own language creations.

---

## Project Structure

The project is contained within a single source file which is then transpiled by HTVM into the target language files (e.g., `oryx_vm.py`, `oryx_vm.js`, `oryx_vm.cpp`).

You do not need to build or compile the Oryx VM yourself. Simply grab the transpiled library file for your language of choice and include it in your project.

---

## License

This project is licensed under the **GNU General Public License v3.0**. A copy of the license can be found in the `LICENSE` file.
